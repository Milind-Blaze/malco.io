<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.5.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Malcolm Barrett">

  
  
  
    
  
  <meta name="description" content="Update with markovifyR Thanks to Maëlle Salmon, who referred me to this post by Julia Silge and Nick Larsen, I explored doing this using the markovifyR package, and the results are unbelievable. See the bottom of the post for an updated batch of sonnets!
 Original post I recently saw Katie Jolly’s post, in which she produced Rupi Kuar-style poems using Markov Chains in R. I absolutely loved it, so I decided to try it with Shakespeare’s 154 sonnets using her post as a skeleton.">

  
  <link rel="alternate" hreflang="en-us" href="/2018/01/26/stochastic-shakespeare-sonnets-produced-by-markov-chains-in-r/">

  


  
  
  
  <meta name="theme-color" content="#0072B2">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/atelier-forest-light.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/atelier-forest-light.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Karla:300,400,500%7CIBM+Plex+Sans:300,400,500%7CRoboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.df8fd8733249a7fbb9ddd57129b7872f.css">

  
    
    
    
    
      
    
    
    
    <link rel="stylesheet" href="/css/academic.60ce589d21aa386e05f4a4b39b4a3cb2.css">
  

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/2018/01/26/stochastic-shakespeare-sonnets-produced-by-markov-chains-in-r/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@malco_barrett">
  <meta property="twitter:creator" content="@malco_barrett">
  
  <meta property="og:site_name" content="Malcolm Barrett">
  <meta property="og:url" content="/2018/01/26/stochastic-shakespeare-sonnets-produced-by-markov-chains-in-r/">
  <meta property="og:title" content="Stochastic Shakespeare: Sonnets Produced by Markov Chains in R | Malcolm Barrett">
  <meta property="og:description" content="Update with markovifyR Thanks to Maëlle Salmon, who referred me to this post by Julia Silge and Nick Larsen, I explored doing this using the markovifyR package, and the results are unbelievable. See the bottom of the post for an updated batch of sonnets!
 Original post I recently saw Katie Jolly’s post, in which she produced Rupi Kuar-style poems using Markov Chains in R. I absolutely loved it, so I decided to try it with Shakespeare’s 154 sonnets using her post as a skeleton."><meta property="og:image" content="/img/icon-192.png">
  <meta property="twitter:image" content="/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2018-01-26T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2018-01-26T00:00:00&#43;00:00">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/2018/01/26/stochastic-shakespeare-sonnets-produced-by-markov-chains-in-r/"
  },
  "headline": "Stochastic Shakespeare: Sonnets Produced by Markov Chains in R",
  
  "datePublished": "2018-01-26T00:00:00Z",
  "dateModified": "2018-01-26T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Malcolm Barrett"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Malcolm Barrett",
    "logo": {
      "@type": "ImageObject",
      "url": "/img/icon-512.png"
    }
  },
  "description": "Update with markovifyR Thanks to Maëlle Salmon, who referred me to this post by Julia Silge and Nick Larsen, I explored doing this using the markovifyR package, and the results are unbelievable. See the bottom of the post for an updated batch of sonnets!\n Original post I recently saw Katie Jolly’s post, in which she produced Rupi Kuar-style poems using Markov Chains in R. I absolutely loved it, so I decided to try it with Shakespeare’s 154 sonnets using her post as a skeleton."
}
</script>

  

  


  


  





  <title>Stochastic Shakespeare: Sonnets Produced by Markov Chains in R | Malcolm Barrett</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Malcolm Barrett</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/post"><span>Blog</span></a>
        </li>

        
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/talk"><span>Talks</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/training"><span>Training</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/consulting"><span>Consulting</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/abooutme"><span>About me</span></a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        

      </ul>

    </div>
  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Stochastic Shakespeare: Sonnets Produced by Markov Chains in R</h1>

  

  
    



<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Jan 26, 2018
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    9 min read
  </span>
  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/r/">r</a></span>
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/2018/01/26/stochastic-shakespeare-sonnets-produced-by-markov-chains-in-r/&amp;text=Stochastic%20Shakespeare:%20Sonnets%20Produced%20by%20Markov%20Chains%20in%20R" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/2018/01/26/stochastic-shakespeare-sonnets-produced-by-markov-chains-in-r/&amp;t=Stochastic%20Shakespeare:%20Sonnets%20Produced%20by%20Markov%20Chains%20in%20R" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Stochastic%20Shakespeare:%20Sonnets%20Produced%20by%20Markov%20Chains%20in%20R&amp;body=/2018/01/26/stochastic-shakespeare-sonnets-produced-by-markov-chains-in-r/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/2018/01/26/stochastic-shakespeare-sonnets-produced-by-markov-chains-in-r/&amp;title=Stochastic%20Shakespeare:%20Sonnets%20Produced%20by%20Markov%20Chains%20in%20R" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Stochastic%20Shakespeare:%20Sonnets%20Produced%20by%20Markov%20Chains%20in%20R%20/2018/01/26/stochastic-shakespeare-sonnets-produced-by-markov-chains-in-r/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/2018/01/26/stochastic-shakespeare-sonnets-produced-by-markov-chains-in-r/&amp;title=Stochastic%20Shakespeare:%20Sonnets%20Produced%20by%20Markov%20Chains%20in%20R" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>


  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      


<div id="update-with-markovifyr" class="section level1">
<h1>Update with <code>markovifyR</code></h1>
<p>Thanks to Maëlle Salmon, who referred me to <a href="https://stackoverflow.blog/2018/01/15/thanks-million-jon-skeet/">this post</a> by Julia Silge and Nick Larsen, I explored doing this using the <code>markovifyR</code> package, and the results are unbelievable. <a href="#update">See the bottom of the post for an updated batch of sonnets!</a></p>
</div>
<div id="original-post" class="section level1">
<h1>Original post</h1>
<p>I recently saw <a href="http://katiejolly.io/blog/2018-01-05/random-rupi-markov-chain-poems">Katie Jolly’s post</a>, in which she produced Rupi Kuar-style poems using Markov Chains in R. I absolutely loved it, so I decided to try it with Shakespeare’s 154 sonnets using her post as a skeleton.</p>
</div>
<div id="downloading-and-cleaning-the-sonnets" class="section level1">
<h1>Downloading and cleaning the sonnets</h1>
<p>In addition to <code>markovchain</code> and <code>tidyverse</code>, I’m going to use the <code>gutenberger</code> package to download the sonnets.</p>
<pre class="r"><code>library(gutenbergr)
library(tidyverse) 
library(markovchain) </code></pre>
<pre class="r"><code>shakespeare &lt;- gutenberg_works(title == &quot;Shakespeare&#39;s Sonnets&quot;) %&gt;% 
  pull(gutenberg_id) %&gt;% 
  gutenberg_download(verbose = FALSE)

shakespeare</code></pre>
<pre><code>## # A tibble: 2,625 x 2
##    gutenberg_id text                                          
##           &lt;int&gt; &lt;chr&gt;                                         
##  1         1041 THE SONNETS                                   
##  2         1041 &quot;&quot;                                            
##  3         1041 by William Shakespeare                        
##  4         1041 &quot;&quot;                                            
##  5         1041 &quot;&quot;                                            
##  6         1041 &quot;&quot;                                            
##  7         1041 &quot;&quot;                                            
##  8         1041 &quot;  I&quot;                                         
##  9         1041 &quot;&quot;                                            
## 10         1041 &quot;  From fairest creatures we desire increase,&quot;
## # … with 2,615 more rows</code></pre>
<p>Because the sonnets are in <code>gutenberger</code>, they’re already in a nice format to work with. I just need to do a little cleaning up: like Katie, I removed the punctuation, but I also have to clear out the sonnet titles, which were Roman numerals, and some title info.</p>
<pre class="r"><code>#  a little function to make life easier
`%not_in%` &lt;- function(lhs, rhs) {
  !(lhs %in% rhs)
}

#  remove new lines symbol, sonnet Roman numerals, and punctation
#  and split into vector
bills_words &lt;- shakespeare %&gt;% 
  mutate(text = text %&gt;% 
    str_trim() %&gt;% 
    str_replace_all(&quot;--&quot;, &quot; &quot;) %&gt;% 
    str_replace_all(&quot;[^[:alnum:][:space:]&#39;]&quot;, &quot;&quot;) %&gt;% 
    str_replace_all(&quot;^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$&quot;, 
                    &quot;&quot;) %&gt;% 
    str_to_lower()) %&gt;% 
  filter(text %not_in% c(&quot;the sonnets&quot;, &quot;by william shakespeare&quot;, &quot;&quot;, &quot; &quot;)) %&gt;% 
  pull(text) %&gt;% 
  str_split(&quot; &quot;) %&gt;% 
  unlist() </code></pre>
<p>I’m also going to extract the punctuation and assess how many of each there are for when I actually assemble the sonnets later.</p>
<pre class="r"><code>punctuation &lt;- shakespeare %&gt;% 
  pull(text) %&gt;% 
  str_extract_all(&quot;[^[:alnum:][:space:]&#39;]&quot;) %&gt;% 
  unlist()

punctuation_probs &lt;- punctuation[punctuation %not_in% c(&quot;-&quot;, &quot;(&quot;, &quot;)&quot;)] %&gt;% 
  table() %&gt;% 
  prop.table()</code></pre>
</div>
<div id="fit-the-markov-chain" class="section level1">
<h1>Fit the Markov Chain</h1>
<p>Now fit the Markov Chain with the vector of words.</p>
<pre class="r"><code>#  fit a Markov Chain
sonnet_chain &lt;- markovchainFit(bills_words)
cat(markovchainSequence(n = 10, markovchain = sonnet_chain$estimate), collapse =  &quot; &quot;)</code></pre>
<p>i can afford no longer nurseth the joy my poverty</p>
<p><img src="https://media.giphy.com/media/bXKWWJXUJkBsQ/giphy.gif" /></p>
<p>And finally, here are a few functions to piece together lines to make them look like a sonnet using the <code>walk()</code> function from <code>purrr</code> to print out the lines (since it’s a side effect). No, they’re not actually iambic pentameter :(</p>
<pre class="r"><code>write_a_line &lt;- function(n_lines = 1) {
  walk(1:n_lines, function(.x) {
  # put together lines of more or less average length
    lines &lt;- markovchainSequence(n = sample(c(6:9), 1), 
                               markovchain = sonnet_chain$estimate) %&gt;% 
      paste(collapse = &quot; &quot;)
  
  #  add end-of-line punctuation based on their occurence 
  end_punctuation &lt;- ifelse(.x == n_lines, &quot;.&quot;, 
                            sample(names(punctuation_probs), 
                                   size = 1, 
                                   prob = punctuation_probs))
  cat(paste0(lines, end_punctuation, &quot;  \n&quot;))
  })
}

psuedosonnet &lt;- function() {
  walk(1:3, function(.x) {
    write_a_line(4)
    cat(&quot;  \n&quot;)
  })
  
  write_a_line(2)
}</code></pre>
</div>
<div id="generating-the-sonnets" class="section level1">
<h1>Generating the sonnets</h1>
<p>Let’s try it out.</p>
<div id="psuedosonnet-1" class="section level2">
<h2>Psuedosonnet 1:</h2>
<pre class="r"><code>set.seed(154)
psuedosonnet()</code></pre>
<p>wing and folly doctorlike controlling skill who knows the,<br />
again assur’d and given grace but when all date:<br />
shook three till my mind these blenches,<br />
in sweetest things deem’d not so dear delight.</p>
<p>the mouths of love swearing in these,<br />
and soon to woe compar’d with;<br />
at your bounty cherish she is ’greeing and yet,<br />
by lies buried age and simple savour pitiful thrivers.</p>
<p>am now with intelligence as the stage presenteth nought,<br />
which it for me suffering my?<br />
days making lascivious grace is not thy days are:<br />
expired for myself and tombs of my.</p>
<p>right my heart another gay why dost,<br />
of my use your self thou.</p>
</div>
<div id="psuedosonnet-2" class="section level2">
<h2>Psuedosonnet 2:</h2>
<pre class="r"><code>psuedosonnet()</code></pre>
<p>past reason hunted and checked with thee;<br />
or changes right or at least so strong,<br />
the ashes of glass his prescriptions,<br />
him to decay lest eyes be false borrowed face.</p>
<p>and all kinds of love her blood that,<br />
o none but in these offices so.<br />
and his spring within the view!<br />
to weigh how thy book of.</p>
<p>by a tomb of public means which,<br />
or who moving points on to?<br />
can yet do see my state and age unbred?<br />
muse brings forth the orient when.</p>
<p>thy hair the world away to show thee:<br />
one by day when in love things.</p>
</div>
<div id="psuedosonnet-3" class="section level2">
<h2>Psuedosonnet 3:</h2>
<pre class="r"><code>psuedosonnet()</code></pre>
<p>or else receiv’st not fade die but.<br />
grief to mend to stay whilst;<br />
reeks i hold thee devouring time that,<br />
with you pattern of such day my love happy.</p>
<p>hate me last so bright who leaves thy beauty.<br />
each friend and your true that one that,<br />
whilst like a vengeful canker blooms?<br />
and therefore my bad thus to.</p>
<p>should i not counted fair whose,<br />
state but day arising from hands to;<br />
of flower with his presence grace impiety,<br />
only herald to the beast that plea.</p>
<p>eyelids open wide in posterity thou send’st from,<br />
nor shall have err’d and kept unused.</p>
</div>
<div id="psuedosonnet-4" class="section level2">
<h2>Psuedosonnet 4:</h2>
<pre class="r"><code>psuedosonnet()</code></pre>
<p>that pine to my home of thine own,<br />
love being crown’d with that man’s;<br />
what need’st thou usurer why of this thy love’s,<br />
with sovereign cure i question make him that i.</p>
<p>to the ear confounds him have drawn,<br />
fight and beauty should my muse and strangely.<br />
liv’d alone stands but one so,<br />
whilst i alone o in the lines that brightness.</p>
<p>creature the lease dost wake elsewhere but me;<br />
evil tempteth my love that which still,<br />
i am attainted that in the thing to.<br />
it thy sweet deaths be but those.</p>
<p>that our appetite which he is hanging still:<br />
inhabit on death to make one.</p>
</div>
<div id="psuedosonnet-5" class="section level2">
<h2>Psuedosonnet 5:</h2>
<pre class="r"><code>psuedosonnet()</code></pre>
<p>and confounds in me not my?<br />
alchemy to all my comfort now i send,<br />
the pleasure thine own desert and no hatred in,<br />
with disdain lest guilty goddess go since.</p>
<p>seem right myself i’ll fight after you,<br />
wane so love and simple truth.<br />
ah do dispense you like of time despite,<br />
to store harsh featureless and by.</p>
<p>my reason is daily new lo,<br />
love thee i’ll run and in themselves forsake me;<br />
thou through windows to play as ’twixt a,<br />
me both and to love of.</p>
<p>still my bonds in disgrace with newer:<br />
morrow to slavery my side against the weary.</p>
<p><img src="https://media.giphy.com/media/3o6Ztf18L1Tsmxd528/giphy.gif" /></p>
</div>
</div>
<div id="update" class="section level1">
<h1>Update</h1>
<p>Alright, this time I’m going to try it with the <code>markovifyR</code> package. I’m basically going to do the same cleaning as above, but this time I’ll be putting entire sentences, punctuation and all, into the Markov model. The <code>markovify_text()</code> function also accepts start words, so I thought it might look good to start with a sample of 100 starting words from the sonnets and construct the lines from there.</p>
<pre class="r"><code>library(markovifyR)</code></pre>
<pre class="r"><code>#  same as above, but maintain as sentences and keep punctuation
bills_sentences &lt;- shakespeare %&gt;% 
  mutate(text = text %&gt;% 
    str_trim() %&gt;% 
    str_replace_all(&quot;--&quot;, &quot; &quot;) %&gt;% 
    str_replace_all(&quot;^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$&quot;, 
                    &quot;&quot;) %&gt;% 
    str_to_lower()) %&gt;% 
  filter(text %not_in% c(&quot;the sonnets&quot;, &quot;by william shakespeare&quot;, &quot;&quot;, &quot; &quot;))

#  fit the Markov Chain
markovify_model &lt;-
  generate_markovify_model(
    input_text = bills_sentences$text,
    markov_state_size = 2L,
    max_overlap_total = 25,
    max_overlap_ratio = .85
  )

#  generate a sonnet
markovify_sonnet &lt;- function() {
  lines &lt;- markovify_text(
      markov_model = markovify_model,
      maximum_sentence_length = 75,
      output_column_name = &#39;sonnet_line&#39;,
      count = 50,
      tries = 1000, 
      start_words = sample(generate_start_words(markovify_model)$wordStart, 100),
      only_distinct = TRUE,
      return_message = FALSE) %&gt;% 
    filter(str_count(sonnet_line, &quot;\\w+&quot;) &gt; 5 &amp; str_count(sonnet_line, &quot;\\w+&quot;) &lt; 10) %&gt;% 
    slice(sample(1:n(), 14)) %&gt;% 
    mutate(id = 1:n()) %&gt;% 
    select(id, sonnet_line) 
  
   #  add a period to the last line if the last charachter isn&#39;t punctuation 
   #  that ends a sentence  
   last_line &lt;- lines[lines$id == 14, &quot;sonnet_line&quot;]
   lines[lines$id == 14, &quot;sonnet_line&quot;] &lt;- str_replace(last_line, 
                                                       &quot;.$(?&lt;!//.//!//?|[:alnum:])&quot;, &quot;.&quot;)
   
   #  print in a sonnet-like format
   walk(1:14, function(.x) {
     cat(lines$sonnet_line[.x], &quot; \n&quot;)
     
     #  add a space every four lines
     if (.x %% 4 == 0) cat(&quot;\n&quot;) 
   })
}</code></pre>
<div id="markovify-sonnet-1" class="section level2">
<h2>Markovify Sonnet 1:</h2>
<pre class="r"><code>markovify_sonnet()</code></pre>
<p>now counting best to be invited<br />
then, in the breath of words respect,<br />
are windows to my dear time’s waste:<br />
speak of that which thou departest;</p>
<p>speak of my faults thy sweet graces graced be;<br />
reserve them for my sin you did impute,<br />
then, beauteous niggard, why dost thou to mine eyes,<br />
die to themselves. sweet roses do not kill</p>
<p>this silence for my love, yea take them all;<br />
are windows to my thoughts as food to life,<br />
beauty’s effect with beauty of thy days.<br />
there is but as the rich, whose blessed key,</p>
<p>this were to be cross’d:<br />
not from the book of honour razed quite.</p>
</div>
<div id="markovify-sonnet-2" class="section level2">
<h2>Markovify Sonnet 2:</h2>
<pre class="r"><code>markovify_sonnet()</code></pre>
<p>thine eyes i love, and look strange;<br />
haply i think my love alone.<br />
which should transport me farthest from your tongue;<br />
entitled in thy power to lend base subjects light?</p>
<p>wishing me like to the very same;<br />
not that the world’s fresh ornament,<br />
looking with pretty ruth upon my brow;<br />
of faults conceal’d, wherein i am forsworn,</p>
<p>too base of thee this i do change:<br />
now all is done, save what is told.<br />
to this composed wonder of your fame!<br />
disdains the tillage of thy days.</p>
<p>till i return, of posting is no remedy,<br />
not wondering at the present nor the prophetic soul</p>
</div>
<div id="markovify-sonnet-3" class="section level2">
<h2>Markovify Sonnet 3:</h2>
<pre class="r"><code>markovify_sonnet()</code></pre>
<p>want nothing that the world an end,<br />
kill me with that which it doth catch;<br />
within the knowledge of mine own love’s might.<br />
o! change thy thought, that i prove,</p>
<p>within the level of your love.<br />
presume not on thy humour doth depend:<br />
ere you were once unkind befriends me now,<br />
when sometime lofty towers i see thee,</p>
<p>wishing me like to the world enjoys it;<br />
who taught thee how thy precious minutes waste;<br />
mad in pursuit of the time,<br />
have added feathers to the time,</p>
<p>the summer’s flower is to render thee.<br />
what merit do i not to be invited</p>
</div>
<div id="markovify-sonnet-4" class="section level2">
<h2>Markovify Sonnet 4:</h2>
<pre class="r"><code>markovify_sonnet()</code></pre>
<p>o, no! it is a man right fair,<br />
by seeing farther than my barren rhyme?<br />
even that your love taught it this alchemy,<br />
theirs for their habitation chose out thee,</p>
<p>just to the edge of doom.<br />
full many a holy and obsequious tear<br />
two loves i have frequent been with unknown minds,<br />
how have mine eyes be blessed made</p>
<p>speak of that which still doth grow?<br />
kind is my love’s breath? the purple pride<br />
him in thy steel bosom’s ward,<br />
even so, being full of blame,</p>
<p>speak of the dead, which now appear<br />
will be true despite thy scythe and crooked knife.</p>
</div>
<div id="markovify-sonnet-5" class="section level2">
<h2>Markovify Sonnet 5:</h2>
<pre class="r"><code>markovify_sonnet()</code></pre>
<p>never believe though in thy creation did decree<br />
make but my five senses can<br />
but all alone beweep my outcast state,<br />
alack! what poverty my muse want subject to invent,</p>
<p>but wherefore do not do the thing they see;<br />
lo! in the number let me be borne alone.<br />
steal from his low tract, and look strange;<br />
so, either by thy beauty being mute,</p>
<p>betwixt mine eye loves it and doth first begin.<br />
whence hast thou this becoming of their excellence.<br />
dost thou to mine own worth do define,<br />
wretched in this line some interest,</p>
<p>yet, do thy worst to steal thyself away,<br />
although thou steal thy sweet self prove.</p>
<p><img src="https://media.giphy.com/media/JPW7lVDXKJgXu/giphy.gif" width="75%" /></p>
<p>Well, call me Shockedspeare.</p>
<p><em>Exit, pursued by a bear</em></p>
</div>
</div>

    </div>

    


    

<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/textanalysis/">textanalysis</a>
  
</div>



    
      








  






  
  
  
    
  
  
  <div class="media author-card">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hu7cd8e03fae7dee7e08991da728c996e4_129746_250x250_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Malcolm Barrett</a></h5>
      <h6 class="card-subtitle">PhD Student in Epidemiology</h6>
      <p class="card-text">Malcolm Barrett is a PhD student in Epidemiology at the University of Southern California. He has worked on both mature and nascent cohort studies, as well as in several clinical settings. He served for two years in AmeriCorps at Federally-Qualified Health Centers and is committed to science as service. matter.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:malcolmbarrett@gmail.com" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/malco_barrett" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/malcolm-barrett-33b307138" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/malcolmbarrett" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>



      
      
    

    

    


  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
      

      
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin="anonymous"></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.6cbefe3f0755301b86cd38317ded9f54.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    &copy; 2019 Malcolm Barrett &middot; 
    
    <a href="https://github.com/malcolmbarrett/malco.io" target="_blank" rel="noopener"><i class="fas fa-code-branch" style="color:#0072B2"></i></a>  &middot; 
    
    Made with the <a href="https://cran.r-project.org/" target="_blank" rel="noopener"><i class="fab fa-r-project"></i> </a><a href="https://github.com/rstudio/blogdown" target="_blank" rel="noopener">blogdown</a> package and the 
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>
  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
